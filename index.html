<html lang="en-GB">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Robust and Diverse Multi-Agent Learning via Rational Policy Gradient</title>
    <meta name="description"
        content="We present a novel approach to policy gradient methods that preserves rationality in reinforcement learning agents.">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <meta name="robots" content="all">
    <meta content="en_EN" property="og:locale">
    <meta content="website" property="og:type">
    <meta content="https://shikun.io/projects/clarity" property="og:url">
    <meta content="Robust and Diverse Multi-Agent Learning via Rational Policy Gradient" property="og:title">
    <meta
        content="A novel approach to policy gradient methods that preserves rationality in reinforcement learning agents."
        property="og:description">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@your_twitter_id">
    <meta name="twitter:description"
        content="Robust and Diverse Multi-Agent Learning via Rational Policy Gradient: A novel approach to policy gradient methods that preserves rationality in reinforcement learning agents.">
    <meta name="twitter:image:src" content="assets/figures/clarity.png">

    <link rel="stylesheet" type="text/css" media="all" href="assets/stylesheets/main_free.css" />
    <link rel="stylesheet" type="text/css" media="all" href="clarity/clarity.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/foundation.min.css">
    <link href="assets/fontawesome-free-6.6.0-web/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/img-comparison-slider@8/dist/styles.css" />
    <script defer src="https://cdn.jsdelivr.net/npm/img-comparison-slider@8/dist/index.js"></script>
    <!-- <script src="assets/scripts/navbar.js"></script>  Comment to remove table of content. -->
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            "HTML-CSS": {
              scale: 95,
              fonts: ["Gyre-Pagella"],
              imageFont: null,
              undefinedFamily: "'Arial Unicode MS', cmbright"
            },
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                processEscapes: true
              }
          });
    </script>
    <script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
        </script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>

<body>
    <!-- Title Page -->
    <!-- Dark Theme Example: Change the background colour dark and change the following div "blog-title" into "blog-title white". -->
    <div class="container blog" id="first-content" style="background-color: #E0E4E6;">
        <!-- If you don't have a project cover: Change "blog-title" into "blog-title no-cover"  -->
        <div class="blog-title no-cover">
            <div class="blog-intro" style="padding-bottom: 30px;">
                <div>
                    <h1 class="title" style="padding-bottom: 15px;">Robust and Diverse Multi-Agent Learning via Rational
                        Policy Gradient</h1>
                    <p class="author" style="padding-top: 10px;">
                        Niklas Lauffer<sup> 1</sup>, Ameesh Shah<sup> 1</sup>, Micah Carroll<sup> 1</sup>, Sanjit
                        Seshia<sup> 1</sup>, Stuart Russell<sup> 1</sup>, Michael Dennis<sup> 2</sup>
                    </p>
                    <p class="author" style="padding-top: 5px; padding-bottom: 0px;">
                        <sup>1</sup>UC Berkeley &nbsp; &nbsp; <sup>2</sup>Google Deepmind
                    </p>
                    <div class="info" style="padding-top: 5px; padding-bottom: 10px;">
                        <p>NeurIPS 2025</p>
                    </div>
                    <div class="info">
                        <div>
                            <a href="paper.pdf" class="button icon" style="background-color: rgba(255, 255, 255, 0.5)">
                                Paper <i class="fa-solid fa-file-text"></i></a> &nbsp;&nbsp;
                            <a href="https://github.com/niklaslauffer/rational-policy-gradient" class="button icon"
                                style="background-color: rgba(255, 255, 255, 0.5)">Code <i
                                    class="fa-solid fa-code"></i></a> &nbsp;&nbsp;
                            <a href="#interactive-visualization" class="button icon"
                                style="background-color: rgba(255, 255, 255, 0.5)">Interactive Visualization <i
                                    class="fa-solid fa-sliders"></i></a> &nbsp;&nbsp;
                            <!-- <a href="https://www.microsoft.com/en-gb/microsoft-365/powerpoint" class="button icon"
                                style="background-color: rgba(255, 255, 255, 0.2);">Slides <i
                                    class="fa-regular fa-file-powerpoint"></i></a> &nbsp;&nbsp;
                            <a href="https://huggingface.co/spaces/" class="button icon"
                                style="background-color: rgba(255, 255, 255, 0.2)">Demo <i
                                    class="fa-solid fa-laptop-code"></i></a> -->
                        </div>
                    </div>
                    <!-- <div class="info" style="padding-top: 5px; padding-bottom: 10px;">
                        <p>Abstract</p>
                    </div> -->
                    <p class="abstract">
                        Adversarial optimization algorithms that explicitly search for flaws in agents' policies have
                        been successfully applied to finding robust and diverse policies in multi-agent settings.
                        However, the success of adversarial optimization has been largely limited to zero-sum settings
                        because its naive application in cooperative settings leads to a critical failure mode: agents
                        are irrationally incentivized to <em>self-sabotage</em>, blocking the completion of tasks and
                        halting further learning. To address this, we introduce <em>Rationality-preserving Policy
                            Optimization (RPO)</em>, a formalism for adversarial optimization that avoids self-sabotage
                        by ensuring agents remain <em>rational</em>—that is, their policies are optimal with respect to
                        some possible partner policy. To solve RPO, we develop <em>Rational Policy Gradient (RPG)</em>,
                        which trains agents to maximize their own reward in a modified version of the original game in
                        which we use <em>opponent shaping</em> techniques to optimize the adversarial objective. RPG
                        enables us to extend a variety of existing adversarial optimization algorithms that, no longer
                        subject to the limitations of self-sabotage, can find adversarial examples, improve robustness
                        and adaptability, and learn diverse policies. We empirically validate that our approach achieves
                        strong performance in several popular cooperative and general-sum environments.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <div id="interactive-visualization" class="container blog extra-large gray-linear"
        style="display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 0px; min-height: 600px;">

        <!-- Environment Selector - Top of entire container -->
        <div
            style="margin-bottom: 20px; display: flex; gap: 8px; align-items: center; width: 100%; justify-content: center; flex-wrap: wrap;">
            <button onclick="switchEnvironment('forced-coord')" class="env-button active" data-env="forced-coord"
                style="padding: 8px 16px; font-size: 14px; text-align: center; white-space: nowrap; background-color: #2196F3; color: white; border: none; border-radius: 4px; cursor: pointer;">
                Forced Coordination
            </button>
            <button onclick="switchEnvironment('cramped-room')" class="env-button" data-env="cramped-room"
                style="padding: 8px 16px; font-size: 14px; text-align: center; white-space: nowrap; background-color: #dfdfdf; color: #333; border: none; border-radius: 4px; cursor: pointer;">
                Cramped Room
            </button>
            <button onclick="switchEnvironment('coordination-ring')" class="env-button" data-env="coordination-ring"
                style="padding: 8px 16px; font-size: 14px; text-align: center; white-space: nowrap; background-color: #dfdfdf; color: #333; border: none; border-radius: 4px; cursor: pointer;">
                Coordination Ring
            </button>
            <button onclick="switchEnvironment('counter-circuit')" class="env-button" data-env="counter-circuit"
                style="padding: 8px 16px; font-size: 14px; text-align: center; white-space: nowrap; background-color: #dfdfdf; color: #333; border: none; border-radius: 4px; cursor: pointer;">
                Counter Circuit
            </button>
            <button onclick="switchEnvironment('asymmetric-advantage')" class="env-button"
                data-env="asymmetric-advantage"
                style="padding: 8px 16px; font-size: 14px; text-align: center; white-space: nowrap; background-color: #dfdfdf; color: #333; border: none; border-radius: 4px; cursor: pointer;">
                Asymmetric Advantage
            </button>
        </div>

        <!-- Main content row with heatmap and video -->
        <div
            style="display: flex; flex-direction: row; align-items: center; justify-content: center; gap: 0px; width: 100%;">
            <!-- Left column - Heatmap and grid -->
            <div style="flex: 1; max-width: 50%; display: flex; flex-direction: column; align-items: center;">
                <!-- Interactive Title -->
                <h3 style="margin-bottom: 10px; text-align: center; color: #333;">Interactive grid: click any square
                    below!
                </h3>

                <div id="heatmap-container" style="position: relative; display: inline-block; width: 100%; margin: 0;">
                    <img id="heatmap-image" src="assets/figures/rpg-forced-coord-heatmap.png"
                        style="width: 100%; height: auto; display: block;">
                    <!-- Interactive grid overlay - 6x6 grid -->
                    <div id="grid-overlay">
                        <!-- Row 0 -->
                        <div class="grid-cell" data-env="forced-coord" data-row="0" data-col="0" data-video="0-0.mp4">
                        </div>
                        <div class="grid-cell" data-env="forced-coord" data-row="0" data-col="1" data-video="0-1.mp4">
                        </div>
                        <div class="grid-cell" data-env="forced-coord" data-row="0" data-col="2" data-video="0-2.mp4">
                        </div>
                        <div class="grid-cell" data-env="forced-coord" data-row="0" data-col="3" data-video="0-3.mp4">
                        </div>
                        <div class="grid-cell" data-env="forced-coord" data-row="0" data-col="4" data-video="0-4.mp4">
                        </div>
                        <div class="grid-cell" data-env="forced-coord" data-row="0" data-col="5" data-video="0-5.mp4">
                        </div>
                        <!-- Row 1 -->
                        <div class="grid-cell" data-env="forced-coord" data-row="1" data-col="0" data-video="1-0.mp4">
                        </div>
                        <div class="grid-cell" data-env="forced-coord" data-row="1" data-col="1" data-video="1-1.mp4">
                        </div>
                        <div class="grid-cell" data-env="forced-coord" data-row="1" data-col="2" data-video="1-2.mp4">
                        </div>
                        <div class="grid-cell" data-env="forced-coord" data-row="1" data-col="3" data-video="1-3.mp4">
                        </div>
                        <div class="grid-cell selected" data-env="forced-coord" data-row="1" data-col="4"
                            data-video="1-4.mp4"></div>
                        <div class="grid-cell" data-env="forced-coord" data-row="1" data-col="5" data-video="1-5.mp4">
                        </div>
                        <!-- Row 2 -->
                        <div class="grid-cell" data-env="forced-coord" data-row="2" data-col="0" data-video="2-0.mp4">
                        </div>
                        <div class="grid-cell" data-env="forced-coord" data-row="2" data-col="1" data-video="2-1.mp4">
                        </div>
                        <div class="grid-cell" data-env="forced-coord" data-row="2" data-col="2" data-video="2-2.mp4">
                        </div>
                        <div class="grid-cell" data-env="forced-coord" data-row="2" data-col="3" data-video="2-3.mp4">
                        </div>
                        <div class="grid-cell" data-env="forced-coord" data-row="2" data-col="4" data-video="2-4.mp4">
                        </div>
                        <div class="grid-cell" data-env="forced-coord" data-row="2" data-col="5" data-video="2-5.mp4">
                        </div>
                        <!-- Row 3 -->
                        <div class="grid-cell" data-env="forced-coord" data-row="3" data-col="0" data-video="3-0.mp4">
                        </div>
                        <div class="grid-cell" data-env="forced-coord" data-row="3" data-col="1" data-video="3-1.mp4">
                        </div>
                        <div class="grid-cell" data-env="forced-coord" data-row="3" data-col="2" data-video="3-2.mp4">
                        </div>
                        <div class="grid-cell" data-env="forced-coord" data-row="3" data-col="3" data-video="3-3.mp4">
                        </div>
                        <div class="grid-cell" data-env="forced-coord" data-row="3" data-col="4" data-video="3-4.mp4">
                        </div>
                        <div class="grid-cell" data-env="forced-coord" data-row="3" data-col="5" data-video="3-5.mp4">
                        </div>
                        <!-- Row 4 -->
                        <div class="grid-cell" data-env="forced-coord" data-row="4" data-col="0" data-video="4-0.mp4">
                        </div>
                        <div class="grid-cell" data-env="forced-coord" data-row="4" data-col="1" data-video="4-1.mp4">
                        </div>
                        <div class="grid-cell" data-env="forced-coord" data-row="4" data-col="2" data-video="4-2.mp4">
                        </div>
                        <div class="grid-cell" data-env="forced-coord" data-row="4" data-col="3" data-video="4-3.mp4">
                        </div>
                        <div class="grid-cell" data-env="forced-coord" data-row="4" data-col="4" data-video="4-4.mp4">
                        </div>
                        <div class="grid-cell" data-env="forced-coord" data-row="4" data-col="5" data-video="4-5.mp4">
                        </div>
                        <!-- Row 5 -->
                        <div class="grid-cell" data-env="forced-coord" data-row="5" data-col="0" data-video="5-0.mp4">
                        </div>
                        <div class="grid-cell" data-env="forced-coord" data-row="5" data-col="1" data-video="5-1.mp4">
                        </div>
                        <div class="grid-cell" data-env="forced-coord" data-row="5" data-col="2" data-video="5-2.mp4">
                        </div>
                        <div class="grid-cell" data-env="forced-coord" data-row="5" data-col="3" data-video="5-3.mp4">
                        </div>
                        <div class="grid-cell" data-env="forced-coord" data-row="5" data-col="4" data-video="5-4.mp4">
                        </div>
                        <div class="grid-cell" data-env="forced-coord" data-row="5" data-col="5" data-video="5-5.mp4">
                        </div>

                        <!-- Cramped Room Environment Grid Cells -->
                        <div class="grid-cell selected" data-env="cramped-room" data-row="0" data-col="0"
                            data-video="0-0.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="0" data-col="1" data-video="0-1.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="0" data-col="2" data-video="0-2.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="0" data-col="3" data-video="0-3.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="0" data-col="4" data-video="0-4.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="0" data-col="5" data-video="0-5.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="1" data-col="0" data-video="1-0.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="1" data-col="1" data-video="1-1.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="1" data-col="2" data-video="1-2.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="1" data-col="3" data-video="1-3.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="1" data-col="4" data-video="1-4.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="1" data-col="5" data-video="1-5.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="2" data-col="0" data-video="2-0.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="2" data-col="1" data-video="2-1.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="2" data-col="2" data-video="2-2.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="2" data-col="3" data-video="2-3.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="2" data-col="4" data-video="2-4.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="2" data-col="5" data-video="2-5.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="3" data-col="0" data-video="3-0.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="3" data-col="1" data-video="3-1.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="3" data-col="2" data-video="3-2.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="3" data-col="3" data-video="3-3.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="3" data-col="4" data-video="3-4.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="3" data-col="5" data-video="3-5.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="4" data-col="0" data-video="4-0.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="4" data-col="1" data-video="4-1.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="4" data-col="2" data-video="4-2.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="4" data-col="3" data-video="4-3.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="4" data-col="4" data-video="4-4.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="4" data-col="5" data-video="4-5.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="5" data-col="0" data-video="5-0.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="5" data-col="1" data-video="5-1.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="5" data-col="2" data-video="5-2.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="5" data-col="3" data-video="5-3.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="5" data-col="4" data-video="5-4.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="cramped-room" data-row="5" data-col="5" data-video="5-5.mp4"
                            style="display: none;"></div>

                        <!-- Other Environment Grid Cells (simplified for brevity) -->
                        <!-- Asymmetric Advantage -->
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="0" data-col="0"
                            data-video="0-0.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="0" data-col="1"
                            data-video="0-1.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="0" data-col="2"
                            data-video="0-2.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="0" data-col="3"
                            data-video="0-3.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="0" data-col="4"
                            data-video="0-4.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="0" data-col="5"
                            data-video="0-5.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="1" data-col="0"
                            data-video="1-0.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="1" data-col="1"
                            data-video="1-1.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="1" data-col="2"
                            data-video="1-2.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="1" data-col="3"
                            data-video="1-3.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="1" data-col="4"
                            data-video="1-4.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="1" data-col="5"
                            data-video="1-5.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="2" data-col="0"
                            data-video="2-0.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="2" data-col="1"
                            data-video="2-1.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="2" data-col="2"
                            data-video="2-2.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="2" data-col="3"
                            data-video="2-3.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="2" data-col="4"
                            data-video="2-4.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="2" data-col="5"
                            data-video="2-5.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="3" data-col="0"
                            data-video="3-0.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="3" data-col="1"
                            data-video="3-1.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="3" data-col="2"
                            data-video="3-2.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="3" data-col="3"
                            data-video="3-3.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="3" data-col="4"
                            data-video="3-4.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="3" data-col="5"
                            data-video="3-5.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="4" data-col="0"
                            data-video="4-0.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="4" data-col="1"
                            data-video="4-1.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="4" data-col="2"
                            data-video="4-2.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="4" data-col="3"
                            data-video="4-3.mp4" style="display: none;"></div>
                        <div class="grid-cell selected" data-env="asymmetric-advantage" data-row="4" data-col="4"
                            data-video="4-4.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="4" data-col="5"
                            data-video="4-5.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="5" data-col="0"
                            data-video="5-0.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="5" data-col="1"
                            data-video="5-1.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="5" data-col="2"
                            data-video="5-2.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="5" data-col="3"
                            data-video="5-3.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="5" data-col="4"
                            data-video="5-4.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="asymmetric-advantage" data-row="5" data-col="5"
                            data-video="5-5.mp4" style="display: none;"></div>

                        <!-- Coordination Ring -->
                        <div class="grid-cell" data-env="coordination-ring" data-row="0" data-col="0"
                            data-video="0-0.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="0" data-col="1"
                            data-video="0-1.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="0" data-col="2"
                            data-video="0-2.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="0" data-col="3"
                            data-video="0-3.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="0" data-col="4"
                            data-video="0-4.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="0" data-col="5"
                            data-video="0-5.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="1" data-col="0"
                            data-video="1-0.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="1" data-col="1"
                            data-video="1-1.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="1" data-col="2"
                            data-video="1-2.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="1" data-col="3"
                            data-video="1-3.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="1" data-col="4"
                            data-video="1-4.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="1" data-col="5"
                            data-video="1-5.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="2" data-col="0"
                            data-video="2-0.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="2" data-col="1"
                            data-video="2-1.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="2" data-col="2"
                            data-video="2-2.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="2" data-col="3"
                            data-video="2-3.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="2" data-col="4"
                            data-video="2-4.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="2" data-col="5"
                            data-video="2-5.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="3" data-col="0"
                            data-video="3-0.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="3" data-col="1"
                            data-video="3-1.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="3" data-col="2"
                            data-video="3-2.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="3" data-col="3"
                            data-video="3-3.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="3" data-col="4"
                            data-video="3-4.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="3" data-col="5"
                            data-video="3-5.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="4" data-col="0"
                            data-video="4-0.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="4" data-col="1"
                            data-video="4-1.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="4" data-col="2"
                            data-video="4-2.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="4" data-col="3"
                            data-video="4-3.mp4" style="display: none;"></div>
                        <div class="grid-cell selected" data-env="coordination-ring" data-row="4" data-col="4"
                            data-video="4-4.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="4" data-col="5"
                            data-video="4-5.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="5" data-col="0"
                            data-video="5-0.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="5" data-col="1"
                            data-video="5-1.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="5" data-col="2"
                            data-video="5-2.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="5" data-col="3"
                            data-video="5-3.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="5" data-col="4"
                            data-video="5-4.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="coordination-ring" data-row="5" data-col="5"
                            data-video="5-5.mp4" style="display: none;"></div>

                        <!-- Counter Circuit -->
                        <div class="grid-cell" data-env="counter-circuit" data-row="0" data-col="0" data-video="0-0.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="0" data-col="1" data-video="0-1.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="0" data-col="2" data-video="0-2.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="0" data-col="3" data-video="0-3.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="0" data-col="4" data-video="0-4.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="0" data-col="5" data-video="0-5.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="1" data-col="0" data-video="1-0.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="1" data-col="1" data-video="1-1.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="1" data-col="2" data-video="1-2.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="1" data-col="3" data-video="1-3.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="1" data-col="4" data-video="1-4.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="1" data-col="5" data-video="1-5.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="2" data-col="0" data-video="2-0.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="2" data-col="1" data-video="2-1.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="2" data-col="2" data-video="2-2.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="2" data-col="3" data-video="2-3.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="2" data-col="4" data-video="2-4.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="2" data-col="5" data-video="2-5.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="3" data-col="0" data-video="3-0.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="3" data-col="1" data-video="3-1.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="3" data-col="2" data-video="3-2.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="3" data-col="3" data-video="3-3.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="3" data-col="4" data-video="3-4.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="3" data-col="5" data-video="3-5.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="4" data-col="0" data-video="4-0.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="4" data-col="1" data-video="4-1.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="4" data-col="2" data-video="4-2.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="4" data-col="3" data-video="4-3.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell selected" data-env="counter-circuit" data-row="4" data-col="4"
                            data-video="4-4.mp4" style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="4" data-col="5" data-video="4-5.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="5" data-col="0" data-video="5-0.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="5" data-col="1" data-video="5-1.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="5" data-col="2" data-video="5-2.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="5" data-col="3" data-video="5-3.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="5" data-col="4" data-video="5-4.mp4"
                            style="display: none;"></div>
                        <div class="grid-cell" data-env="counter-circuit" data-row="5" data-col="5" data-video="5-5.mp4"
                            style="display: none;"></div>
                    </div>
                </div>
                <!-- Grid Selection Buttons -->
                <div id="grid-selection-buttons"
                    style="margin-top: 10px; margin-bottom: 5px; display: flex; flex-direction: row; gap: 8px; align-items: center; width: 100%; justify-content: center;">
                    <!-- Forced Coordination buttons -->
                    <button onclick="selectGridCell(0, 1)" class="button grid-button" data-env="forced-coord"
                        style="padding: 6px 12px; font-size: 12px; text-align: center; white-space: nowrap;">
                        SP fails to generalize
                    </button>
                    <button onclick="selectGridCell(0, 4)" class="button grid-button" data-env="forced-coord"
                        style="padding: 6px 12px; font-size: 12px; text-align: center; white-space: nowrap;">
                        AD-RPG adapts...
                    </button>
                    <button onclick="selectGridCell(1, 4)" class="button grid-button" data-env="forced-coord"
                        style="padding: 6px 12px; font-size: 12px; text-align: center; white-space: nowrap;">
                        ...to any strategy
                    </button>

                    <!-- Cramped Room buttons -->
                    <button onclick="selectGridCell(0, 0)" class="button grid-button" data-env="cramped-room"
                        style="padding: 6px 12px; font-size: 12px; text-align: center; white-space: nowrap; display: none;">
                        SP fails in-population
                    </button>
                    <button onclick="selectGridCell(4, 4)" class="button grid-button" data-env="cramped-room"
                        style="padding: 6px 12px; font-size: 12px; text-align: center; white-space: nowrap; display: none;">
                        AD-RPG succeeds across seeds...
                    </button>
                    <button onclick="selectGridCell(0, 2)" class="button grid-button" data-env="cramped-room"
                        style="padding: 6px 12px; font-size: 12px; text-align: center; white-space: nowrap; display: none;">
                        ...and other algorithms
                    </button>

                    <!-- Coordination Ring buttons -->
                    <button onclick="selectGridCell(0, 0)" class="button grid-button" data-env="coordination-ring"
                        style="padding: 6px 12px; font-size: 12px; text-align: center; white-space: nowrap; display: none;">
                        SP ends up stuck
                    </button>
                    <button onclick="selectGridCell(2, 2)" class="button grid-button" data-env="coordination-ring"
                        style="padding: 6px 12px; font-size: 12px; text-align: center; white-space: nowrap; display: none;">
                        So does AD
                    </button>
                    <button onclick="selectGridCell(4, 4)" class="button grid-button" data-env="coordination-ring"
                        style="padding: 6px 12px; font-size: 12px; text-align: center; white-space: nowrap; display: none;">
                        AD-RPG succeeds
                    </button>

                    <!-- Counter Circuit buttons -->
                    <button onclick="selectGridCell(0, 0)" class="button grid-button" data-env="counter-circuit"
                        style="padding: 6px 12px; font-size: 12px; text-align: center; white-space: nowrap; display: none;">
                        SP ends up stuck
                    </button>
                    <button onclick="selectGridCell(2, 2)" class="button grid-button" data-env="counter-circuit"
                        style="padding: 6px 12px; font-size: 12px; text-align: center; white-space: nowrap; display: none;">
                        AD doesn't make it far
                    </button>
                    <button onclick="selectGridCell(4, 4)" class="button grid-button" data-env="counter-circuit"
                        style="padding: 6px 12px; font-size: 12px; text-align: center; white-space: nowrap; display: none;">
                        AD-RPG learns patience
                    </button>

                    <!-- Asymmetric Advantage buttons -->
                    <button onclick="selectGridCell(0, 0)" class="button grid-button" data-env="asymmetric-advantage"
                        style="padding: 6px 12px; font-size: 12px; text-align: center; white-space: nowrap; display: none;">
                        SP converges on one strategy
                    </button>
                    <button onclick="selectGridCell(4, 4)" class="button grid-button" data-env="asymmetric-advantage"
                        style="padding: 6px 12px; font-size: 12px; text-align: center; white-space: nowrap; display: none;">
                        AD-RPG also succeeds...
                    </button>
                    <button onclick="selectGridCell(1, 4)" class="button grid-button" data-env="asymmetric-advantage"
                        style="padding: 6px 12px; font-size: 12px; text-align: center; white-space: nowrap; display: none;">
                        ...and is able to adapt across partners
                    </button>
                </div>
                <!-- <div style="height: 60px; display: flex; align-items: flex-start;">
                <p class="caption" style="margin-top: 10px; width: 100%; text-align: center; margin-bottom: 0;">
                    <b>Interactive cross-play grid in the <em>Forced Coordination</em> environment</b>.
                </p>
            </div> -->
            </div>

            <!-- Right column - Video player and controls -->
            <div style="flex: 1; max-width: 45%; display: flex; flex-direction: column; align-items: center;">
                <div class="video-control">
                    <a class="button" onclick="SlowVideo('eschernet')"><i class="fa-solid fa-backward"></i></a>
                    <!-- Using FontAwesome Pro -->
                    <!-- <a class="button"onclick="ToggleVideo('eschernet')"><i class="fa-solid fa-play-pause"></i></a> -->

                    <!-- Using FontAwesome Free -->
                    <a class="button" id="toggle-video-btn" onclick="ToggleVideo('eschernet')"><i
                            class="fa-solid fa-pause"></i></a>

                    <a class="button" onclick="FastVideo('eschernet')"><i class="fa-solid fa-forward"></i></a>
                    <a class="button" onclick="RestartVideo('eschernet')"><i class="fa-solid fa-rotate-left"></i></a>
                </div>

                <div class="">
                    <p class="video-speed" id="eschernet-msg">
                        Speed: ×1.00
                    </p>
                </div>

                <div class="video-container">
                    <div style="width: 100%; max-width: 480px;">
                        <video id="interactive-video" loop playsinline muted autoplay class="eschernet-video"
                            src="assets/figures/forced-coordination-videos/1-4.mp4"
                            style=" width: 100%; max-width: 480px; height: auto;">
                        </video>
                        <div style="height: 60px; display: flex; align-items: flex-start;">
                            <p class="caption inline center" id="video-caption"
                                style="width: 100%; text-align: center; margin-top: 5px; margin-bottom: 0;">Click on a
                                grid
                                square to the left to load
                                corresponding
                                video</p>
                        </div>
                    </div>
                </div>
            </div>
        </div> <!-- Close the main content row -->
    </div>


    <div class="container blog main">
        <!-- <h1>
            Interactive Cross-play Grids
        </h1> -->
        <p class="text">
            The interactive cross-play grids above show test-time robustness across different partners
            in the form of
            <em>cross-play grids</em>. Each row and column represents a single seed trained by either self-play (SP)
            with low or high entropy regularization, adversarial diversity (AD), or adversarial diversity - RPG
            (AD-RPG) (ours). The color of each square in the cross-play grid represents the average reward of the
            policies from the two associated seeds played against one another. AD-RPG consistently generalizes better
            across different partners.
            Click on any square in the grid to see a sampled rollout of the pair of policies.
        </p>
    </div>

    <!-- <div class="container blog main">
        <p class="text">
            When AD-RPG is the blue agent, it's able to adapt to any strategy from its partner. Other algorithms aren't
            as robust as they fail to generalize outside of the fixed strategy that their algorithm happens to converge
            on. For example, high and low entropy self-play converge to passing onions on different parts of the
            counter, and thus fail to coordinate when paired with each other. AD-RPG is flexible enough to able to adapt
            to either.
        </p>
    </div> -->


    <div class="container blog main first" id="blog-main">
        <h1>
            Rationality-preserving Policy Optimization
        </h1>
        <p class='text'>
            In order to reap the benefits of adversarial optimization without incurring self-sabotaging behavior, we
            establish a new paradigm for adversarial optimization called <em>Rationality-preserving Policy
                Optimization</em> (RPO). We formalize RPO as an adversarial optimization problem that requires the
            policy to be
            optimal with respect to at least one policy that other agent(s) might play. This can be thought of as
            enforcing the agent to be <em>rational</em>: i.e., the agent must be utility-maximizing for some choice of
            teammates. RPO formalizes the rationality constraint as the following optimization problem:
        </p>
        $$
        \begin{aligned}
        \max_{\pi_i} \ &O_i(\pi_1, \dots,\pi_m) \\
        \text{subject to} \ &\exists \pi_{-i}' \text{ s.t. } \pi_i \in \text{BR}(\pi_{-i}').
        \end{aligned}
        $$
        <p class='text'>
            The rationality constraint imposed by RPO is difficult to directly integrate into a single optimization
            objective.
            To solve RPO, we introduce a novel approach called <em>rational policy gradient (RPG)</em>, which provides a
            gradient-based method for ensuring rational learning while optimizing an adversarial objective. RPG
            introduces a new set of agents called <em>manipulators</em>, one for each of the agents in the original
            optimization problem (which we call <em>base agents</em>).
            In RPG, the base agents only train to maximize their own reward in a copy of the game (called its
            <em>manipulator environment</em>) with their teammates replaced by their manipulator counterparts -- this
            ensures that the base agents are solely learning to be rational.
            Each manipulator uses <a href="https://arxiv.org/abs/1703.05449" target="_blank">opponent-shaping</a> to
            manipulate the base agents' learning
            and guide them towards policies that optimize the adversarial objective (e.g., achieving low reward with one
            another in the original <em>base environment</em>).
            The manipulators are discarded after training and the trained base agents give the solution to the
            RPO-version of the adversarial objective -- whether that be related to robustness, diversity, or some other
            objective. RPG allows us to use adversarial optimization in cooperative settings to
            find adversarial examples, robustify behavior, and discover diverse policies:
        </p>
    </div>
    <!-- <div class="blog-cover" style="padding-top: 30px; padding-bottom: 30px;">
        <img class="foreground" src="assets/figures/rpg-fig1.png" style="width: 100%; height: auto; display: block;">
    </div> -->
    <div class="container blog large">
        <img src="assets/figures/rpg-fig1.png" style="width: 100%;">
        <p class="caption">
            Figure 1: Rational policy gradient (RPG) allows finding rational adversarial examples, robustifying
            behavior, and discovering diverse policies.
        </p>
    </div>
    <div class="container blog main" id="blog-main">
        <p class='text'>
            Our main algorithm for training robust agents using RPG is called <em>Adversarial Diversity - Rational
                Policy Gradient</em> (AD-RPG), an RPG version of the <a
                href="https://openreview.net/forum?id=uLE3WF3-H_5" target="_blank">adversarial diversity</a> algorithm.
            AD-RPG trains
            robust agents by training a population of agents to simultaneously maximize their score with a partner while
            finding strategies that other agents in the population perform poorly against, ultimately improving the
            robustness of the entire population. We compare AD-RPG against classical adversarial diversity (AD) as well
            as self-play (SP) with
            both low (0.01) and high (0.05) entropy coefficients. Figure 2 shows the average <em>in-population
                cross-play</em> reward for
            each algorithm: the average of the cross-play scores from within the population of five seeds of each
            individual algorithm. <strong>AD-RPG performs better than all baselines across the Overcooked environments
                and
                comparably or stronger in Hanabi</strong>.
        </p>
    </div>
    <div class="container blog large">
        <img src="assets/figures/rpg-robustness.png" style="width: 100%;">
        <p class="caption">
            Figure 2: In-population cross-play rewards for different algorithms across environments. Points
            represent pairs of seeds, bar charts represent means, and error bars represent 95% confidence
            intervals.
        </p>
    </div>



    <!-- <div class="container blog main large gray-linear">
        <img src="assets/figures/rpg-robustness.png">
        <p class="caption">
            Figure 1: In-population cross-play rewards for different algorithms across environments. Points
                represent pairs of seeds, bar charts represent means, and error bars represent 95% confidence
                intervals.
        </p>
    </div> -->



    <div class="container blog main">
        <h1>Rational Adversarial Attacks</h1>
        <p class="text">
            RPG can also be used to create rational adversarial attacks that avoid <em>self-sabotage</em>.
            We tested the ability of AP-RPG to discover weaknesses in policies in the <em>Cramped Room</em>
            Overcooked layout. First, we trained a policy using self-play (SP) (visualized in Figure 2),
            then we used both AP and AP-RPG to search for a
            adversarial attacks. Visualized in Figure 3, AP (red agent) finds an <em>irrational</em> policy that
            sabotages the game by blocking the plate
            dispenser, a policy that achieves zero reward, but doesn't reveal any meaningful weaknesses in
            the SP policy (blue agent). Visualized in Figure 4, AP-RPG (red agent) is able to find a <em>rational</em>
            policy that
            achieves a reward of zero against the SP policy that identifies a meaningful weaknesses. Instead of
            simply sabotaging the game like AP, AP-RPG discovers that the victim (blue agent) assumes that the agents
            will move around each other clockwise. The manipulator in AP-RPG incentivizes the adversary (red agent) to
            instead move in a counterclockwise fashion, a perfectly rational strategy, though it happens to be
            incompatible with the victim.
        </p>
    </div>

    <div class="container blog main">
        <div class="columns-3">
            <div style="width: 100%; position: relative;">
                <video id="adversarial-sp-video" src="assets/figures/cramped-room-videos/1-1.mp4" style="width: 100%;"
                    autoplay loop muted playsinline></video>
                <!-- <div id="reset-flash" style="position: absolute; top: 10px; left: 50%; transform: translateX(-50%); 
                    background: rgba(255, 255, 255, 0); color: rgba(255, 255, 255, 0.475); padding: 8px 16px; 
                    font-weight: bold; font-size: 24px; opacity: 0; pointer-events: none; z-index: 10;">
                    RESET
                </div> -->
                <script>
                    document.addEventListener('DOMContentLoaded', function () {
                        var spVideo = document.getElementById('adversarial-sp-video');
                        if (spVideo) {
                            spVideo.playbackRate = 0.3;
                        }
                    });
                </script>
                <p class="caption">
                    Figure 2: A policy trained in self-play that learns to move clockwise around its partner.
                </p>
            </div>


            <div style="width: 100%; position: relative;">
                <video id="adversarial-naive-video" src="assets/figures/adversarial-example-naive.mp4"
                    style="width: 100%;" autoplay loop muted playsinline></video>
                <!-- <div id="reset-flash" style="position: absolute; top: 10px; left: 50%; transform: translateX(-50%); 
                    background: rgba(255, 255, 255, 0); color: rgba(255, 255, 255, 0.475); padding: 8px 16px; 
                    font-weight: bold; font-size: 24px; opacity: 0; pointer-events: none; z-index: 10;">
                    RESET
                </div> -->
                <script>
                    document.addEventListener('DOMContentLoaded', function () {
                        var spVideo = document.getElementById('adversarial-naive-video');
                        if (spVideo) {
                            spVideo.playbackRate = 0.5;
                        }
                    });
                </script>
                <p class="caption">
                    Figure 3: An ordinary adversarial example (red agent) acts irrationally, simply blocking the
                    plate dispenser and preventing progress.
                </p>
            </div>

            <div style="width: 100%; position: relative;">
                <video id="adversarial-video" src="assets/figures/adversarial-attack-gif-trimmed.mp4"
                    style="width: 100%;" autoplay loop muted playsinline></video>
                <div id="reset-flash" style="position: absolute; top: 0px; left: 50%; transform: translateX(-50%); 
                    background: rgba(255, 255, 255, 0); color: rgba(255, 255, 255, 0.475); padding: 8px 16px; 
                    font-weight: bold; font-size: 24px; opacity: 0; pointer-events: none; z-index: 10;">
                    RESET
                </div>
                <script>
                    document.addEventListener('DOMContentLoaded', function () {
                        var spVideo = document.getElementById('adversarial-video');
                        if (spVideo) {
                            spVideo.playbackRate = 0.5;
                        }
                    });
                </script>
                <p class="caption">
                    Figure 4: A rational adversarial example (red agent) found by AD-RPG learns that the victim (blue)
                    can't adapt to counterclockwise movement.
                </p>
            </div>

        </div>
    </div>

    <div class="container blog main">
        <h3>Evaluating robustness against rational adversarial attacks</h3>
        <p class="text">
            To explore the effectiveness of AT-RPG, PAIRED-RPG, AP-RPG, and PAIRED-A-RPG, we use a modified version of
            the STORM environment.
            Table 1 shows the performance of various fixed victims against
            different types of adversarial attacks. The "Victim" and "Training" columns indicate the
            algorithm used to train the victim and the reward achieved during training, respectively. The "AP",
            "PAIRED-A-RPG", and "AP-RPG" columns show the performance against these RPG adversarial attacks.
        </p>
    </div>


    <div class="container blog main gray">
        <div class="table-wrapper">
            <table>
                <thead class="center">
                    <tr>
                        <th></th>
                        <th></th>
                        <th colspan="3" style="background-color: #d6d6d6;">Adversarial Attack Type</th>
                    </tr>
                    <tr>
                        <th>Victim</th>
                        <th>Training</th>
                        <th>AP</th>
                        <th>PAIRED-A-RPG</th>
                        <th>AP-RPG</th>
                    </tr>
                </thead>
                <tbody class="center">
                    <tr>
                        <td>PAIRED</td>
                        <td>0.13</td>
                        <td>0.0</td>
                        <td>0.50</td>
                        <td>0.42</td>
                    </tr>
                    <tr>
                        <td>PAIRED-RPG</td>
                        <td>0.93</td>
                        <td>0.0</td>
                        <td>0.84</td>
                        <td>0.85</td>
                    </tr>
                    <tr>
                        <td>AT</td>
                        <td>0.0</td>
                        <td>0.0</td>
                        <td>0.0</td>
                        <td>0.0</td>
                    </tr>
                    <tr>
                        <td>AT-RPG</td>
                        <td>0.65</td>
                        <td>0.0</td>
                        <td>0.72</td>
                        <td>0.88</td>
                    </tr>
                    <tr>
                        <td>AD</td>
                        <td>0.00</td>
                        <td>0.0</td>
                        <td>0.00</td>
                        <td>0.00</td>
                    </tr>
                    <tr>
                        <td>AD-RPG</td>
                        <td>0.98</td>
                        <td>0.0</td>
                        <td>0.25</td>
                        <td>0.96</td>
                    </tr>
                    <tr>
                        <td>Self-play</td>
                        <td>0.98</td>
                        <td>0.0</td>
                        <td>0.16</td>
                        <td>0.96</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="caption">
            Table 1: The average reward that policies trained by various algorithms ("Victim" column) achieve
            against different adversarial attack types. The "Train" column shows the reward achieved during
            training and the following columns show the reward against different adversarial attack types. The
            AP attack trivially achieves zero reward because it self-sabotages.
        </p>
    </div>

    <div class="container blog main">
        <p class="text">
            As expected, every
            victim achieves zero reward against the AP attack since the adversary simply learns to self-sabotage the
            game by collecting no coins. Likewise, the non-RPG variations of algorithms (AT, PAIRED, AD) fail during
            training due to self-sabotage. PAIRED-A-RPG and AP-RPG are both able to find weaknesses in fixed
            policies and neither is susceptible to sabotage, PAIRED-RPG and AT-RPG training lead to more robust
            policies, indicated by high scores against both PAIRED-A-RPG and AP-RPG attacks.
        </p>
    </div>



    <!-- <div class="container blog main">
        <h1>Conclusion</h1>
        <p class="text">
            Per aptent diam; ut in mauris ultricies torquent conubia dolor. Aliquet venenatis sapien, dictum finibus ad
            dui. Finibus sollicitudin nullam consectetur malesuada molestie semper dolor. Platea eget hac cursus aptent
            maecenas penatibus vulputate. Ligula libero torquent sit per praesent praesent. Sodales risus mattis enim
            odio risus tristique. Dapibus vivamus quis scelerisque sollicitudin penatibus placerat erat. Ante aliquet
            vel; morbi quisque leo morbi. Ac sollicitudin imperdiet lacus integer cursus metus parturient euismod
            sociosqu.
        </p>
    </div> -->

    <div class="container blog main">
        <h2>Citation</h2>
        <!-- <p class="text">
            Dictumst eu himenaeos malesuada nisi eros auctor id suspendisse. Ipsum parturient est vitae proin maecenas.
            Nulla mollis vivamus cras nam dapibus consectetur. Id efficitur ac ultricies ornare at litora. Vestibulum
            nibh cursus eu gravida vivamus sem vulputate. Montes nisi ipsum urna vitae semper suscipit.
        </p> -->
        <pre><code class="plaintext">@article{lauffer2025rpg,
  title={Robust and Diverse Multi-Agent Learning via Rational Policy Gradient},
  author={Lauffer, Niklas and Shah, Ameesh and Carroll, Micah and Seshia, Sanjit and Russell, Stuart and Dennis, Michael},
  journal={Advances in Neural Information Processing Systems},
  year={2025}
}</code></pre>
    </div>

    <!-- Footer Page -->
    <footer>
        <div class="container">
            <p>
                This website is built on the <a href="https://shikun.io/projects/clarity">Clarity Template</a>,
                designed
                by <a href="https://shikun.io/">Shikun Liu</a>.
            </p>
        </div>
    </footer>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="clarity/clarity.js"></script>
    <script src="assets/scripts/main.js"></script>

    <!-- Interactive Heatmap Styles and Script -->
    <style>
        .grid-cell {
            cursor: pointer;
            background: rgba(255, 255, 255, 0);
            border: 1px solid rgba(255, 255, 255, 0);
            transition: all 0.1s ease;
        }

        .grid-cell:hover {
            background: rgba(255, 255, 255, 0.38);
            border: 1px solid rgba(255, 255, 255, 0.778);
        }

        /* CUSTOMIZE THIS SECTION FOR DIFFERENT HIGHLIGHTING STYLES */
        .grid-cell.selected {
            /* Option 1: Current blue highlighting */
            background: rgba(115, 213, 255, 0.174);
            border: 5px solid #2196F3;

            /* Option 8: Glowing effect - uncomment to use */
            /* background: rgba(0, 255, 255, 0.2);
            border: 2px solid rgba(0, 255, 255, 1);
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.6); */
        }

        /* Environment selector button styles */
        .env-button {
            transition: all 0.3s ease;
        }

        .env-button:hover {
            opacity: 0.8;
        }

        .env-button.active {
            background-color: #2196F3 !important;
            color: white !important;
        }

        #interactive-video {
            transition: opacity 0.5s ease;
            width: 320px !important;
            height: 320px !important;
            max-width: 100% !important;
            background-color: rgb(100, 100, 100) !important;
            /* Pixel-perfect scaling - prevents browser blur when scaling up */
            image-rendering: -moz-crisp-edges;
            /* Firefox */
            image-rendering: -webkit-crisp-edges;
            /* Safari */
            image-rendering: pixelated;
            /* Chrome/Edge */
            image-rendering: crisp-edges;
            /* General fallback */
            /* Disable smoothing */
            -ms-interpolation-mode: nearest-neighbor;
            /* IE/Edge legacy */
        }

        /* Prevent layout shifts in video container */
        .video-container {
            min-height: 180px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Responsive grid alignment */
        #heatmap-container {
            max-width: 100%;
        }

        #grid-overlay {
            /* Position and layout */
            position: absolute;
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            grid-template-rows: repeat(6, 1fr);
            gap: 0px;

            /* Adjust these percentages to match where your actual grid is in the image */
            /* You may need to fine-tune these values based on your specific heatmap */
            top: 8.9%;
            /* Distance from top of image to start of grid */
            left: 15.6%;
            /* Distance from left of image to start of grid */
            width: 68.4%;
            /* Width of the actual grid area */
            height: 84.5%;
            /* Height of the actual grid area */

            /* Debug border - remove when positioning is correct */
            /* border: 2px solid red; */
        }

        /* Fix bold styling for caption content */
        #video-caption strong {
            font-weight: bold !important;
        }

        /* Color styling for agent names */
        #video-caption .blue-agent {
            color: rgb(0, 0, 191) !important;
            font-weight: bold !important;
        }

        #video-caption .red-agent {
            color: rgb(206, 0, 0) !important;
            font-weight: bold !important;
        }

        /* Center the speed text at the top of the video */
        .video-speed {
            text-align: center !important;
            margin-bottom: 5px !important;
            font-size: 14px !important;
            color: #666 !important;
        }

        /* Fix button width for play/pause toggle to prevent shifting */
        #toggle-video-btn {
            min-width: 25px !important;
            display: inline-flex !important;
            justify-content: center !important;
            align-items: center !important;
        }

        /* Video control button styling */
        .video-control .button {
            background-color: #dfdfdf !important;
        }

        .video-control .button:hover {
            background-color: #dfdfdf !important;
            opacity: 0.8;
        }

        .video-control .button:active {
            background-color: #dfdfdf !important;
            opacity: 0.5;
        }

        /* Reset flash animation */
        #reset-flash {
            transition: opacity 0.2s ease-in-out !important;
        }

        /* Better caption wrapping */
        .caption {
            word-wrap: break-word;
            hyphens: auto;
            line-height: 1.4;
        }

        /* Ensure video captions wrap properly */
        #video-caption {
            word-wrap: break-word;
            hyphens: auto;
            line-height: 1.4;
            max-width: 100%;
        }

        /* Responsive side-by-side layout */
        @media (max-width: 768px) {
            .container.blog.large.gray-linear[style*="flex-direction: row"] {
                flex-direction: column !important;
                align-items: center !important;
            }

            .container.blog.large.gray-linear[style*="flex-direction: row"]>div {
                max-width: 100% !important;
                flex: none !important;
            }

            /* Stack captions properly on mobile */
            .container.blog.large.gray-linear[style*="flex-direction: row"] .caption {
                text-align: center !important;
                margin-bottom: 20px;
            }
        }

        /* Mobile-specific styles for interactive visualization */
        @media (max-width: 768px) {

            /* Make environment selector buttons smaller on mobile */
            .env-button {
                padding: 6px 10px !important;
                font-size: 12px !important;
                white-space: nowrap;
            }

            /* Stack heatmap and video vertically instead of side by side */
            #interactive-visualization>div:last-child {
                flex-direction: column !important;
                gap: 20px !important;
            }

            /* Make both columns full width on mobile */
            #interactive-visualization>div:last-child>div {
                flex: none !important;
                max-width: 100% !important;
                width: 100% !important;
            }

            /* Make grid selection buttons smaller on mobile */
            .grid-button {
                padding: 4px 8px !important;
                font-size: 10px !important;
                white-space: nowrap;
            }

            /* Adjust spacing for mobile */
            #interactive-visualization {
                gap: 10px !important;
                min-height: auto !important;
                padding: 10px !important;
            }

            /* Make environment selector wrap better on mobile */
            #interactive-visualization>div:first-child {
                margin-bottom: 15px !important;
                gap: 6px !important;
            }
        }

        /* Extra small mobile devices */
        @media (max-width: 480px) {
            .env-button {
                padding: 4px 8px !important;
                font-size: 11px !important;
            }

            .grid-button {
                padding: 3px 6px !important;
                font-size: 9px !important;
            }
        }
    </style>
    <script>
        // Environment configuration
        const environments = {
            'forced-coord': {
                name: 'Forced Coordination',
                heatmapImage: 'assets/figures/rpg-forced-coord-heatmap.png',
                videoPath: 'assets/figures/forced-coordination-videos/',
                defaultSelection: { row: 1, col: 4 }
            },
            'cramped-room': {
                name: 'Cramped Room',
                heatmapImage: 'assets/figures/cramped-room-heatmap.png',
                videoPath: 'assets/figures/cramped-room-videos/',
                defaultSelection: { row: 0, col: 0 }
            },
            'asymmetric-advantage': {
                name: 'Asymmetric Advantage',
                heatmapImage: 'assets/figures/asymm-advantages-heatmap.png',
                videoPath: 'assets/figures/asymm-videos/',
                defaultSelection: { row: 4, col: 4 }
            },
            'coordination-ring': {
                name: 'Coordination Ring',
                heatmapImage: 'assets/figures/coord-ring-heatmap.png',
                videoPath: 'assets/figures/ring-videos/',
                defaultSelection: { row: 4, col: 4 }
            },
            'counter-circuit': {
                name: 'Counter Circuit',
                heatmapImage: 'assets/figures/counter-circuit-heatmap.png',
                videoPath: 'assets/figures/circuit-videos/',
                defaultSelection: { row: 4, col: 4 }
            }
        };

        let currentEnvironment = 'forced-coord';

        // Function to switch environment
        window.switchEnvironment = function (envId) {
            if (!environments[envId]) return;

            currentEnvironment = envId;
            const env = environments[envId];

            // Update environment button states
            document.querySelectorAll('.env-button').forEach(btn => {
                btn.classList.remove('active');
                btn.style.backgroundColor = '#dfdfdf';
                btn.style.color = '#333';
            });

            const activeBtn = document.querySelector(`.env-button[data-env="${envId}"]`);
            if (activeBtn) {
                activeBtn.classList.add('active');
                activeBtn.style.backgroundColor = '#2196F3';
                activeBtn.style.color = 'white';
            }

            // Update heatmap image
            const heatmapImage = document.getElementById('heatmap-image');
            heatmapImage.src = env.heatmapImage;

            // Hide all grid cells and show only current environment's cells
            document.querySelectorAll('.grid-cell').forEach(cell => {
                cell.classList.remove('selected');
                const cellEnv = cell.getAttribute('data-env');
                if (cellEnv === envId) {
                    cell.style.display = '';
                } else {
                    cell.style.display = 'none';
                }
            });

            // Update grid selection buttons
            document.querySelectorAll('.grid-button').forEach(btn => {
                const btnEnv = btn.getAttribute('data-env');
                if (btnEnv === envId) {
                    btn.style.display = '';
                } else {
                    btn.style.display = 'none';
                }
            });

            // Update button onclick handlers and text based on environment
            const gridButtons = document.querySelectorAll(`.grid-button[data-env="${envId}"]`);
            if (env.buttons && gridButtons.length === env.buttons.length) {
                gridButtons.forEach((btn, index) => {
                    const buttonConfig = env.buttons[index];
                    btn.textContent = buttonConfig.text;
                    btn.onclick = () => selectGridCell(buttonConfig.row, buttonConfig.col);
                });
            }

            // Select default cell for the environment
            const defaultCell = document.querySelector(`.grid-cell[data-env="${envId}"][data-row="${env.defaultSelection.row}"][data-col="${env.defaultSelection.col}"]`);
            if (defaultCell) {
                defaultCell.classList.add('selected');

                // Load default video
                const videoFile = defaultCell.getAttribute('data-video');
                const videoPath = `${env.videoPath}${videoFile}`;
                const video = document.getElementById('interactive-video');

                video.style.opacity = '0.3';
                video.src = videoPath;
                video.load();
                video.playbackRate = 0.5;

                setTimeout(() => {
                    video.style.opacity = '1';
                }, 300);

                // Update caption
                const caption = document.getElementById('video-caption');
                if (caption) {
                    caption.innerHTML = getCaptionText(env.defaultSelection.row, env.defaultSelection.col);
                }
            }
        };

        document.addEventListener('DOMContentLoaded', function () {
            const gridCells = document.querySelectorAll('.grid-cell');
            const video = document.getElementById('interactive-video');
            const heatmapImage = document.getElementById('heatmap-image');
            const gridOverlay = document.getElementById('grid-overlay');

            const adversarialVideo = document.getElementById('adversarial-video');
            const resetFlash = document.getElementById('reset-flash');
            if (adversarialVideo && resetFlash) {
                adversarialVideo.playbackRate = 0.3;

                let lastTime = 0;
                // Add event listener to detect when video loops back to beginning
                adversarialVideo.addEventListener('timeupdate', function () {
                    const currentTime = adversarialVideo.currentTime;

                    // If current time is much smaller than last time, video has looped
                    if (lastTime > 1 && currentTime < 1) {
                        // Flash "RESET" text
                        resetFlash.style.opacity = '1';
                        setTimeout(function () {
                            resetFlash.style.opacity = '0';
                        }, 500); // Flash for 500ms
                    }

                    lastTime = currentTime;
                });
            }

            // Function to update grid positioning based on image size
            function updateGridPosition() {
                // This ensures the grid stays aligned with the image
                const imageRect = heatmapImage.getBoundingClientRect();
                const containerRect = heatmapImage.parentElement.getBoundingClientRect();

                // Optional: Add debug logging to help fine-tune positioning
                // console.log('Image dimensions:', imageRect.width, imageRect.height);
            }

            // Update grid position on window resize
            window.addEventListener('resize', updateGridPosition);

            // Update grid position when image loads
            heatmapImage.addEventListener('load', updateGridPosition);

            // Initial position update
            updateGridPosition();

            // Initialize default selected cell and video
            function initializeDefaultSelection() {
                const env = environments[currentEnvironment];
                const defaultCell = document.querySelector(`.grid-cell[data-env="${currentEnvironment}"].selected`);
                if (defaultCell) {
                    const videoFile = defaultCell.getAttribute('data-video');
                    const row = defaultCell.getAttribute('data-row');
                    const col = defaultCell.getAttribute('data-col');

                    // Set default video using current environment's path
                    const videoPath = `${env.videoPath}${videoFile}`;
                    video.src = videoPath;
                    video.playbackRate = 0.5; // Slow down by half

                    // Update caption
                    const caption = document.getElementById('video-caption');
                    if (caption) {
                        caption.innerHTML = getCaptionText(parseInt(row), parseInt(col));
                    }
                }
            }

            // Function to get caption text based on row and column
            function getCaptionText(row, col) {
                function getLabel(value) {
                    if (value === 0) return "low entropy self-play";
                    if (value === 1) return "high entropy self-play";
                    if (value === 2 || value === 3) return "adversarial diversity";
                    if (value === 4 || value === 5) return "adversarial diversity - RPG";
                    return "Unknown"; // fallback
                }

                const blueLabel = getLabel(col);
                const redLabel = getLabel(row);
                return `The <strong class="blue-agent">blue</strong> agent is trained with <strong>${blueLabel}</strong> and the <strong class="red-agent">red</strong> agent is trained with <strong>${redLabel}</strong>.`;
            }

            // Call initialization after a short delay to ensure everything is loaded
            setTimeout(initializeDefaultSelection, 100);

            // Function to update play/pause icon based on video state
            function updatePlayPauseIcon() {
                const toggleBtn = document.getElementById('toggle-video-btn');
                const toggleIcon = toggleBtn ? toggleBtn.querySelector('i') : null;

                if (toggleIcon) {
                    // Check if video is currently playing
                    if (!video.paused && !video.ended) {
                        toggleIcon.className = 'fa-solid fa-pause';
                    } else {
                        toggleIcon.className = 'fa-solid fa-play';
                    }
                }
            }

            // Add event listeners to automatically update icon when video state changes
            video.addEventListener('play', updatePlayPauseIcon);
            video.addEventListener('pause', updatePlayPauseIcon);
            video.addEventListener('loadeddata', function () {
                // Small delay to ensure autoplay has started
                setTimeout(updatePlayPauseIcon, 100);
            });

            // Function to programmatically select a grid cell
            window.selectGridCell = function (row, col) {
                // Find the grid cell with matching row, col and current environment
                const targetCell = document.querySelector(`.grid-cell[data-env="${currentEnvironment}"][data-row="${row}"][data-col="${col}"]`);
                if (targetCell) {
                    // Simulate a click on the target cell
                    targetCell.click();
                }
            };

            gridCells.forEach(cell => {
                cell.addEventListener('click', function () {
                    // Only handle clicks for cells of the current environment
                    const cellEnv = this.getAttribute('data-env');
                    if (cellEnv !== currentEnvironment) return;

                    // Remove selected class from all cells
                    gridCells.forEach(c => c.classList.remove('selected'));

                    // Add selected class to clicked cell
                    this.classList.add('selected');

                    // Get video filename from data attribute
                    const videoFile = this.getAttribute('data-video');
                    const row = this.getAttribute('data-row');
                    const col = this.getAttribute('data-col');

                    // Update video source using current environment's path
                    const env = environments[currentEnvironment];
                    const videoPath = `${env.videoPath}${videoFile}`;

                    // Smoother video transition to prevent flicker
                    video.style.opacity = '0.3';

                    // Update caption immediately to prevent it from moving
                    const caption = document.getElementById('video-caption');
                    if (caption) {
                        caption.innerHTML = getCaptionText(parseInt(row), parseInt(col));
                    }

                    // Create a new video element to preload
                    const newVideo = document.createElement('video');
                    newVideo.src = videoPath;
                    newVideo.loop = true;
                    newVideo.playsinline = true;
                    newVideo.muted = true;
                    newVideo.playbackRate = 0.5;

                    newVideo.addEventListener('canplaythrough', function () {
                        // Once new video is fully loaded, swap it smoothly
                        video.src = videoPath;
                        video.load();
                        video.playbackRate = 0.5;
                        video.style.opacity = '1';

                        // Update play/pause icon since video will autoplay
                        updatePlayPauseIcon();
                    });

                    newVideo.addEventListener('error', function () {
                        // Fallback if loading fails
                        video.src = videoPath;
                        video.load();
                        video.playbackRate = 0.5;
                        video.style.opacity = '1';

                        // Update play/pause icon since video will autoplay
                        updatePlayPauseIcon();
                    });

                    // Start loading the new video
                    newVideo.load();
                });
            });
        });
    </script>

</body>

</html>